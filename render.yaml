# Este é o arquivo Blueprint para o Render, que define todos os serviços
# necessários para sua aplicação.

# Versão do Blueprint
version: services

services:
  # 1. Serviço de Banco de Dados PostgreSQL
  - type: pserv
    name: meuprojetophp-db
    plan: free # Use 'free' para o plano gratuito
    # Configurações do PostgreSQL
    databaseName: placar_db
    user: placar_user
    # A variável DATABASE_URL é gerada automaticamente pelo Render para este serviço

  # 2. Serviço Web PHP (que usa o Dockerfile)
  - type: web
    name: meuprojetophp-web
    plan: free # Use 'free' para o plano gratuito
    # Conecta ao repositório git
    repo: '{{.RepositoryURL}}' # Render preenche automaticamente
    branch: main
    # O runtime é 'docker' porque você tem um Dockerfile
    runtime: docker
    
    # Comando de inicialização (como no seu Dockerfile)
    startCommand: 'php -S 0.0.0.0:10000 -t /app'
    
    # A porta que seu servidor PHP escuta
    port: 10000
    
    # Variáveis de Ambiente
    envVars:
      # ESSA É A PARTE MAIS IMPORTANTE: Vínculo Secreto
      # O Render pega a DATABASE_URL gerada pelo serviço 'meuprojetophp-db'
      # e injeta ela no Web Service com o nome DATABASE_URL.
      - key: DATABASE_URL
        fromDatabase:
          name: meuprojetophp-db
          property: connectionString
      
      # Outras variáveis (opcional, como o ambiente)
      - key: APP_ENV
        value: production
